<!DOCTYPE html><html lang="vi" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="pv-cache-enabled" content="false"><meta name="generator" content="Jekyll v4.2.0" /><meta property="og:title" content="Tunning Hyper Parameter với scikit-learn" /><meta name="author" content="thanhtt" /><meta property="og:locale" content="vi" /><meta name="description" content="Mở đầu" /><meta property="og:description" content="Mở đầu" /><link rel="canonical" href="https://codetudau.com/posts/tuning-hyper-param-sklearn/" /><meta property="og:url" content="https://codetudau.com/posts/tuning-hyper-param-sklearn/" /><meta property="og:site_name" content="thanhtt" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2021-03-09T01:33:00+07:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Tunning Hyper Parameter với scikit-learn" /><meta name="twitter:site" content="@twitter_username" /><meta name="twitter:creator" content="@thanhtt" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"headline":"Tunning Hyper Parameter với scikit-learn","dateModified":"2021-03-09T01:33:00+07:00","datePublished":"2021-03-09T01:33:00+07:00","description":"Mở đầu","url":"https://codetudau.com/posts/tuning-hyper-param-sklearn/","mainEntityOfPage":{"@type":"WebPage","@id":"https://codetudau.com/posts/tuning-hyper-param-sklearn/"},"@type":"BlogPosting","author":{"@type":"Person","name":"thanhtt"},"@context":"https://schema.org"}</script><title>Tunning Hyper Parameter với scikit-learn | thanhtt</title><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon.png"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon-precomposed.png"><link rel="apple-touch-icon" sizes="57x57" href="/assets/img/favicons/apple-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="/assets/img/favicons/apple-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/assets/img/favicons/apple-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/assets/img/favicons/apple-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/assets/img/favicons/apple-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/assets/img/favicons/apple-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/assets/img/favicons/apple-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/assets/img/favicons/apple-icon-152x152.png"><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-icon-180x180.png"><link rel="icon" type="image/png" sizes="192x192" href="/assets/img/favicons/android-icon-192x192.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="96x96" href="/assets/img/favicons/favicon-96x96.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/manifest.json"><meta name='msapplication-config' content='/assets/img/favicons/browserconfig.xml'><meta name="msapplication-TileColor" content="#ffffff"><meta name="msapplication-TileImage" content="/assets/img/favicons/ms-icon-144x144.png"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="cdn.jsdelivr.net"><link rel="dns-prefetch" href="cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css" integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script defer src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script defer src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id="></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', ''); }); </script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="/assets/img/avatar/ttt-avatar.png" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">thanhtt</a></div><div class="site-subtitle font-italic">thanhtt - Data Engineer</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center"> <a href="https://github.com/thanhttvn" aria-label="github" class="order-3" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a> <a href="https://twitter.com/twitter_username" aria-label="twitter" class="order-4" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['thanhtt.vn93','gmail.com'].join('@')" aria-label="email" class="order-5" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" class="order-6" > <i class="fas fa-rss"></i> </a> <span class="icon-border order-2"></span> <span id="mode-toggle-wrapper" class="order-1"> <i class="mode-toggle fas fa-adjust"></i> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } var self = this; /* always follow the system prefers */ this.sysDarkPrefers.addListener(function() { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.updateMermaid(); }); } /* constructor() */ setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode == ModeToggle.DARK_MODE; } get isLightMode() { return this.mode == ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer) ) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } updateMermaid() { if (typeof mermaid !== "undefined") { let expectedTheme = (this.modeStatus === ModeToggle.DARK_MODE? "dark" : "default"); let config = { theme: expectedTheme }; /* re-render the SVG › <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */ $(".mermaid").each(function() { let svgCode = $(this).prev().children().html(); $(this).removeAttr("data-processed"); $(this).html(svgCode); }); mermaid.initialize(config); mermaid.init(undefined, ".mermaid"); } } flipMode() { if (this.hasMode) { if (this.isSysDarkPrefer) { if (this.isLightMode) { this.clearMode(); } else { this.setLight(); } } else { if (this.isDarkMode) { this.clearMode(); } else { this.setDark(); } } } else { if (this.isSysDarkPrefer) { this.setLight(); } else { this.setDark(); } } this.updateMermaid(); } /* flipMode() */ } /* ModeToggle */ let toggle = new ModeToggle(); $(".mode-toggle").click(function() { toggle.flipMode(); }); </script> </span></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Posts </a> </span> <span>Tunning Hyper Parameter với scikit-learn</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Tunning Hyper Parameter với scikit-learn</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="semi-bold"> thanhtt </span> <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Tue, Mar 9, 2021, 1:33 AM +0700" prep="on" > Mar 9 <i class="unloaded">2021-03-09T01:33:00+07:00</i> </span></div><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1563 words">8 min</span></div></div><div class="post-content"> <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/posts/learning_resources_03-05.png" class="preview-img" alt="Preview Image"><h1 id="mở-đầu">Mở đầu</h1><p>Chào quý vị và các bạn, thời tiết hôm nay nắng đẹp, có những cơn gió thu mát rười rượi. Rảnh quá mang truyện Tấm Cám ra đọc. Có đoạn như thế này:</p><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre><td class="rouge-code"><pre><span class="n">Ít</span> <span class="n">lâu</span> <span class="n">sau</span> <span class="n">nhà</span> <span class="n">vua</span> <span class="n">mở</span> <span class="n">hội</span> <span class="n">trong</span> <span class="n">mấy</span> <span class="n">đêm</span> <span class="n">ngày</span><span class="p">.</span> <span class="n">Già</span> <span class="n">trẻ</span> <span class="n">gái</span> <span class="n">trai</span> <span class="n">các</span> <span class="n">làng</span> <span class="n">đều</span> <span class="n">nô</span> <span class="n">nức</span> <span class="n">đi</span> <span class="n">xem</span><span class="p">,</span> <span class="n">trên</span> <span class="n">các</span> <span class="n">nẻo</span> <span class="n">đường</span><span class="p">,</span> <span class="n">quần</span> <span class="n">áo</span> <span class="n">mớ</span> <span class="n">ba</span> <span class="n">mớ</span> <span class="n">bẩy</span> <span class="n">dập</span> <span class="n">dìu</span> <span class="n">tuôn</span> <span class="n">về</span> <span class="n">kinh</span> <span class="n">như</span> <span class="n">nước</span> <span class="n">chảy</span><span class="p">.</span> <span class="n">Hai</span> <span class="n">mẹ</span> <span class="n">con</span> <span class="n">Cám</span> <span class="n">cũng</span> <span class="n">sắm</span> <span class="n">sửa</span> <span class="n">quần</span> <span class="n">áo</span> <span class="n">đẹp</span> <span class="n">để</span> <span class="n">đi</span> <span class="n">trẩy</span> <span class="n">hội</span><span class="p">.</span> <span class="n">Thấy</span> <span class="n">Tấm</span> <span class="n">cũng</span> <span class="n">muốn</span> <span class="n">đi</span><span class="p">,</span> <span class="n">mụ</span> <span class="n">dì</span> <span class="n">ghẻ</span> <span class="n">nguýt</span> <span class="n">dài</span><span class="p">,</span> <span class="n">sau</span> <span class="n">đó</span> <span class="n">mụ</span> <span class="n">lấy</span> <span class="n">một</span> <span class="n">đấu</span> <span class="n">gạo</span> <span class="n">trộn</span> <span class="n">lẫn</span> <span class="n">với</span> <span class="n">một</span> <span class="n">đấu</span> <span class="n">thóc</span><span class="p">,</span> <span class="n">bảo</span> <span class="n">Tấm</span><span class="p">:</span>

<span class="o">-</span> <span class="n">Khi</span> <span class="n">nào</span> <span class="n">nhặt</span> <span class="n">riêng</span> <span class="n">gạo</span> <span class="n">và</span> <span class="n">thóc</span> <span class="n">ra</span> <span class="n">hai</span> <span class="n">đấu</span> <span class="n">thì</span> <span class="n">mới</span> <span class="n">được</span> <span class="n">đi</span> <span class="n">xem</span> <span class="n">hội</span><span class="p">.</span>

<span class="n">Nói</span> <span class="n">đoạn</span><span class="p">,</span> <span class="n">hai</span> <span class="n">mẹ</span> <span class="n">con</span> <span class="n">quần</span> <span class="n">áo</span> <span class="n">xúng</span> <span class="n">xính</span> <span class="n">lên</span> <span class="n">đường</span><span class="p">.</span> <span class="n">Tấm</span> <span class="n">tủi</span> <span class="n">thân</span> <span class="n">òa</span> <span class="n">lên</span> <span class="n">khóc</span><span class="p">.</span> <span class="n">Bụt</span> <span class="n">lại</span> <span class="n">hiện</span> <span class="n">lên</span> <span class="n">hỏi</span><span class="p">:</span>

<span class="o">-</span> <span class="n">Làm</span> <span class="n">sao</span> <span class="n">con</span> <span class="n">khóc</span><span class="err">?</span>

<span class="n">Tấm</span> <span class="n">chỉ</span> <span class="n">vào</span> <span class="n">cái</span> <span class="n">thúng</span><span class="p">,</span> <span class="n">thưa</span><span class="p">:</span>

<span class="o">-</span> <span class="n">Dì</span> <span class="n">con</span> <span class="n">bắt</span> <span class="n">phải</span> <span class="n">nhặt</span> <span class="n">thóc</span> <span class="n">ra</span> <span class="n">thóc</span><span class="p">,</span> <span class="n">gạo</span> <span class="n">ra</span> <span class="n">gạo</span><span class="p">,</span> <span class="n">rồi</span> <span class="n">mới</span> <span class="n">được</span> <span class="n">đi</span> <span class="n">xem</span> <span class="n">hội</span><span class="p">,</span> <span class="n">lúc</span> <span class="n">nhặt</span> <span class="n">xong</span> <span class="n">thì</span> <span class="n">hội</span> <span class="n">đã</span> <span class="n">tan</span> <span class="n">rồi</span> <span class="n">còn</span> <span class="n">gì</span> <span class="n">mà</span> <span class="n">xem</span><span class="p">.</span>

<span class="n">Bụt</span> <span class="n">bảo</span><span class="p">:</span> <span class="o">-</span> <span class="n">Con</span> <span class="n">đừng</span> <span class="n">khóc</span> <span class="n">nữa</span><span class="p">.</span> <span class="n">Con</span> <span class="n">mang</span> <span class="n">cái</span> <span class="n">thúng</span> <span class="n">đặt</span> <span class="n">ra</span> <span class="n">giữa</span> <span class="n">sân</span><span class="p">,</span> <span class="n">để</span> <span class="n">ta</span> <span class="n">sai</span> <span class="n">chim</span> <span class="n">sẻ</span> <span class="n">xuống</span> <span class="n">nhặt</span> <span class="n">giúp</span><span class="p">.</span>
</pre></table></code></div></div><p>Chợt nghĩ ra có một vấn đề hơi có tý liên quan mình muốn chia sẻ với các bạn, đó chính là việc tìm kiếm HyperParameter cho model. Và tất nhiên trong lúc làm việc không có ông bụt nào giúp bạn tìm hyper parameter cả ^^.</p><p>Ông bụt chính là bạn, và có thể coi scikit-learn như những con chim sẻ, cần cù thử các Parameter rồi tìm ra giá trị tốt nhất. Thú vị phết nhỉ. Còn cụ thể ra sao cùng tìm hiểu nhé.</p><h1 id="tunning-parameter-là-gì-">Tunning Parameter là gì ???</h1><p>Với các model bạn đang sử dụng, điều không thể thiếu là các parameter, và tất nhiên là tuỳ thuộc mỗi bài toán cụ thể, số dữ liệu training bạn đang có, sẽ có các parameter thích hợp. Và việc thử nhiều parameter khác nhau là điều đương nhiên cần thiết.</p><p>Ví dụ như <code class="language-plaintext highlighter-rouge">RandomForest</code> có các parameter như: <code class="language-plaintext highlighter-rouge">n_estimators, max_features, max_depth, min_samples_split...</code> Và việc thay đổi giá trị các parameter trên sẽ ảnh hưởng đến độ chính xác của model, công việc của chúng ta là tìm cho bằng được parameter đẹp trai nhất. Chính là việc <code class="language-plaintext highlighter-rouge">Tunning HyperParameter</code>.</p><h1 id="grid-search-và-random-search">Grid Search và Random Search</h1><p>Hôm nay mình sẽ giới thiệu 2 phương pháp chính, giang hồ gọi tên là : <code class="language-plaintext highlighter-rouge">Grid Search</code> và <code class="language-plaintext highlighter-rouge">Random Search</code>.</p><p>Ví dụ chúng ta đang cần tunning với 2 parameter, cùng xem 2 đại hiệp kia sẻ xử lý chúng ra sao nhỉ.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/posts/2017/10/grid-search.png" alt="grid-search" /></p><p>Với Grid Search, giả dụ giá trị của 2 parameter lần lượt từ 0-9. Grid Search sẽ lần lượt ghép từng giá trị của param 1 với param 2 để tính toán độ chính xác của model. Đảm bảo không bỏ sót cặp parameter nào.</p><p>Ưu điểm: Diệt nhầm còn hơn bỏ sót, nên thường được ưu tiên lựa chọn.</p><p>Nhược điểm: Tuy nhiên đối với các model cần thiết lập nhiều parameter và nhiều giá trị thì việc tunning sẽ mất rất nhiều thời gian, hàng giờ, vài giờ thậm chỉ có thể tính bằng ngày.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/posts/2017/10/random-search.png" alt="random-search" /></p><p>Còn với Random Search, đúng như tên gọi, từ những giá trị parameter bạn setting, Random Search sẽ chọn ngẫu nhiên các cặp parameter để tiến hành độ chính xác của model.</p><p>Ưu điểm: Random nên sẽ không chạy đủ các trường hợp như Grid Search nên sẽ nhanh hơn đáng kể.</p><p>Nhược điểm: được cái lọ thì mất cái chai. Rất dễ bị trường hợp bỏ qua hyper parameter nhất.</p><h1 id="ứng-dụng">Ứng dụng</h1><p>Cả 2 phương pháp trên đều được scikit-learn hỗ trợ. Lần này mình sử dụng data Machine Learning Repository từ UCI, thử nghiệm với 2 cách trên. Code trên <code class="language-plaintext highlighter-rouge">jupyter notebook</code> với <code class="language-plaintext highlighter-rouge">python2.7</code>.</p><h2 id="bước-1-dowload-data">Bước 1: Dowload data</h2><p>Bộ data này phục vụ trong việc chuẩn đoán ác tính, lành tính với căn bệnh ung thư vú ^^.</p><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s">'https://archive.ics.uci.edu/ml/machine-learning-databases'</span>
                  <span class="s">'/breast-cancer-wisconsin/wdbc.data'</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>
<span class="n">df</span><span class="p">.</span><span class="n">shape</span>

<span class="c1"># (569, 32)
</span></pre></table></code></div></div><h2 id="bước-2-chia-data">Bước 2: Chia data</h2><p>Chúng ta cần chia data làm 2 phần feature data và target data.</p><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
</pre><td class="rouge-code"><pre><span class="n">X_feature</span> <span class="o">=</span> <span class="n">df</span><span class="p">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">:].</span><span class="n">values</span>
<span class="n">y_label</span> <span class="o">=</span> <span class="n">df</span><span class="p">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">].</span><span class="n">values</span>

<span class="n">X_feature</span>

<span class="c1"># array([[  1.79900000e+01,   1.03800000e+01,   1.22800000e+02, ...,
#           2.65400000e-01,   4.60100000e-01,   1.18900000e-01],
#        [  2.05700000e+01,   1.77700000e+01,   1.32900000e+02, ...,
#           1.86000000e-01,   2.75000000e-01,   8.90200000e-02],
#        [  1.96900000e+01,   2.12500000e+01,   1.30000000e+02, ...,
#           2.43000000e-01,   3.61300000e-01,   8.75800000e-02],
#        ...,
#        [  1.66000000e+01,   2.80800000e+01,   1.08300000e+02, ...,
#           1.41800000e-01,   2.21800000e-01,   7.82000000e-02],
#        [  2.06000000e+01,   2.93300000e+01,   1.40100000e+02, ...,
#           2.65000000e-01,   4.08700000e-01,   1.24000000e-01],
#        [  7.76000000e+00,   2.45400000e+01,   4.79200000e+01, ...,
#           0.00000000e+00,   2.87100000e-01,   7.03900000e-02]])
</span>
<span class="n">y_label</span>

<span class="c1"># array(['M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M',
#        'M', 'M', 'M', 'M', 'M', 'M', 'B', 'B', 'B', 'M', 'M', 'M', 'M',
#        'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'M', 'B', 'M',
#        'M', 'M', 'M', 'M', 'M', 'M', 'M', 'B', 'M', 'B', 'B', 'B', 'B',
#        'B', 'M', 'M', 'B', 'M', 'M', 'B', 'B', 'B', 'B', 'M', 'B', 'M',
#        'M', 'B', 'B', 'B', 'B', 'M', 'B', 'M', 'M', 'B', 'M', 'B', 'M',
#        'M', 'B', 'B', 'B', 'M', 'M', 'B', 'M', 'M', 'M', 'B', 'B', 'B',
#        'M', 'B', 'B', 'M', 'M', 'B', 'B', 'B', 'M', 'M', 'B', 'B', 'B',
</span></pre></table></code></div></div><p>Tiếp theo đương nhiên cần chia thành 2 bộ data training và test.</p><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre><span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>

<span class="c1"># test size: 20%
# random_state: đảm bảo mỗi lần split đều ra output giống nhau.
</span><span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span>
    <span class="n">X_feature</span><span class="p">,</span> <span class="n">y_label</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.20</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">1</span>
<span class="p">)</span>

</pre></table></code></div></div><h2 id="bước-3-sử-dụng-default-parameter-thử-tìm-độ-chính-xác-của-model">Bước 3: Sử dụng default parameter thử tìm độ chính xác của model</h2><p>Ở bài toán này, mình sử dụng model RandomForest, đương nhiên với các model khác cũng tương tự.</p><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
</pre><td class="rouge-code"><pre><span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">classification_report</span>
<span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">RandomForestClassifier</span>

<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">classification_report</span>

 <span class="k">def</span> <span class="nf">model_check</span><span class="p">(</span><span class="n">model</span><span class="p">):</span>
     <span class="n">model</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span><span class="n">y_train</span><span class="p">)</span>
     <span class="n">y_train_pred</span> <span class="o">=</span> <span class="n">classification_report</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span><span class="n">model</span><span class="p">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train</span><span class="p">))</span>
     <span class="n">y_test_pred</span>  <span class="o">=</span> <span class="n">classification_report</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span><span class="n">model</span><span class="p">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">))</span>

     <span class="k">print</span><span class="p">(</span><span class="s">"""【{model_name}】</span><span class="se">\n</span><span class="s"> Train Accuracy: </span><span class="se">\n</span><span class="s">{train}
           </span><span class="se">\n</span><span class="s"> Test Accuracy:  </span><span class="se">\n</span><span class="s">{test}"""</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="n">model_name</span><span class="o">=</span><span class="n">model</span><span class="p">.</span><span class="n">__class__</span><span class="p">.</span><span class="n">__name__</span><span class="p">,</span> <span class="n">train</span><span class="o">=</span><span class="n">y_train_pred</span><span class="p">,</span> <span class="n">test</span><span class="o">=</span><span class="n">y_test_pred</span><span class="p">))</span>

<span class="k">print</span><span class="p">(</span><span class="n">model_check</span><span class="p">(</span><span class="n">RandomForestClassifier</span><span class="p">()))</span>

<span class="c1"># [RandomForestClassifier]
#      Train Accuracy:
#                  precision    recall  f1-score   support
#
#               B       1.00      1.00      1.00        67
#               M       1.00      1.00      1.00        75
#
#     avg / total       1.00      1.00      1.00       142
#
#
#      Test Accuracy:
#                  precision    recall  f1-score   support
#
#               B       0.89      0.93      0.91        72
#               M       0.93      0.89      0.91        70
#
#     avg / total       0.91      0.91      0.91       142
</span></pre></table></code></div></div><p>Độ chính xác khi thử với tập train là 100%, còn với tập test data là 91%, bây giờ chúng ta thử tunning parameter xem có thể tìm ra được model nào tốt hơn không.</p><h2 id="bước-4-thử-với-grid-search">Bước 4: Thử với Grid Search</h2><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
</pre><td class="rouge-code"><pre> <span class="c1">#Grid search
</span>
 <span class="kn">from</span> <span class="nn">sklearn.grid_search</span> <span class="kn">import</span> <span class="n">GridSearchCV</span>

 <span class="c1"># use a full grid over all parameters
</span> <span class="n">param_grid</span> <span class="o">=</span> <span class="p">{</span><span class="s">"max_depth"</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span> <span class="bp">None</span><span class="p">],</span>
              <span class="s">"n_estimators"</span><span class="p">:[</span><span class="mi">50</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span><span class="mi">200</span><span class="p">,</span><span class="mi">300</span><span class="p">,</span><span class="mi">400</span><span class="p">,</span><span class="mi">500</span><span class="p">],</span>
              <span class="s">"max_features"</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span>
              <span class="s">"min_samples_split"</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span>
              <span class="s">"min_samples_leaf"</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span>
              <span class="s">"bootstrap"</span><span class="p">:</span> <span class="p">[</span><span class="bp">True</span><span class="p">,</span> <span class="bp">False</span><span class="p">],</span>
              <span class="s">"criterion"</span><span class="p">:</span> <span class="p">[</span><span class="s">"gini"</span><span class="p">,</span> <span class="s">"entropy"</span><span class="p">]}</span>

 <span class="n">forest_grid</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span><span class="n">estimator</span><span class="o">=</span><span class="n">RandomForestClassifier</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span>
                 <span class="n">param_grid</span> <span class="o">=</span> <span class="n">param_grid</span><span class="p">,</span>   
                 <span class="n">scoring</span><span class="o">=</span><span class="s">"accuracy"</span><span class="p">,</span>  <span class="c1">#metrics
</span>                 <span class="n">cv</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>              <span class="c1">#cross-validation
</span>                 <span class="n">n_jobs</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>          <span class="c1">#number of core
</span>
 <span class="n">forest_grid</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span><span class="n">y_train</span><span class="p">)</span> <span class="c1">#fit
</span>
 <span class="n">forest_grid_best</span> <span class="o">=</span> <span class="n">forest_grid</span><span class="p">.</span><span class="n">best_estimator_</span> <span class="c1">#best estimator
</span> <span class="k">print</span><span class="p">(</span><span class="s">"Best Model Parameter: "</span><span class="p">,</span><span class="n">forest_grid</span><span class="p">.</span><span class="n">best_params_</span><span class="p">)</span>

<span class="c1">#    [RandomForestClassifier]
#      Train Accuracy:
#                  precision    recall  f1-score   support
#
#               B       0.99      0.99      0.99        67
#               M       0.99      0.99      0.99        75
#
#     avg / total       0.99      0.99      0.99       142
#
#
#      Test Accuracy:  
#                  precision    recall  f1-score   support
#
#               B       0.96      0.89      0.92        72
#               M       0.89      0.96      0.92        70
#
#     avg / total       0.92      0.92      0.92       142
</span></pre></table></code></div></div><p>Kết quả độ chính xác, f1-score đã được cải thiện</p><h2 id="bước-5-thử-với-random-search">Bước 5: Thử với Random Search</h2><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
</pre><td class="rouge-code"><pre><span class="c1">#Random search
</span><span class="kn">from</span> <span class="nn">sklearn.grid_search</span> <span class="kn">import</span> <span class="n">RandomizedSearchCV</span>
<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">randint</span> <span class="k">as</span> <span class="n">sp_randint</span>

<span class="n">param_dist</span> <span class="o">=</span> <span class="p">{</span><span class="s">"max_depth"</span><span class="p">:</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="bp">None</span><span class="p">],</span>                  <span class="c1">#distribution
</span>              <span class="s">"n_estimators"</span><span class="p">:[</span><span class="mi">50</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span><span class="mi">200</span><span class="p">,</span><span class="mi">300</span><span class="p">,</span><span class="mi">400</span><span class="p">,</span><span class="mi">500</span><span class="p">],</span>
              <span class="s">"max_features"</span><span class="p">:</span> <span class="n">sp_randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">11</span><span class="p">),</span>
              <span class="s">"min_samples_split"</span><span class="p">:</span> <span class="n">sp_randint</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">11</span><span class="p">),</span>
              <span class="s">"min_samples_leaf"</span><span class="p">:</span> <span class="n">sp_randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">11</span><span class="p">),</span>
              <span class="s">"bootstrap"</span><span class="p">:</span> <span class="p">[</span><span class="bp">True</span><span class="p">,</span> <span class="bp">False</span><span class="p">],</span>
              <span class="s">"criterion"</span><span class="p">:</span> <span class="p">[</span><span class="s">"gini"</span><span class="p">,</span> <span class="s">"entropy"</span><span class="p">]}</span>

<span class="n">forest_random</span> <span class="o">=</span> <span class="n">RandomizedSearchCV</span><span class="p">(</span> <span class="n">estimator</span><span class="o">=</span><span class="n">RandomForestClassifier</span><span class="p">(</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span> <span class="p">),</span>
                                    <span class="n">param_distributions</span><span class="o">=</span><span class="n">param_dist</span><span class="p">,</span>
                                    <span class="n">cv</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>              <span class="c1">#CV
</span>                                    <span class="n">n_iter</span><span class="o">=</span><span class="mi">1944</span><span class="p">,</span>          <span class="c1">#interation num
</span>                                    <span class="n">scoring</span><span class="o">=</span><span class="s">"accuracy"</span><span class="p">,</span> <span class="c1">#metrics
</span>                                    <span class="n">n_jobs</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>           <span class="c1">#num of core
</span>                                    <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>          
                                    <span class="n">random_state</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">forest_random</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
<span class="n">forest_random_best</span> <span class="o">=</span> <span class="n">forest_random</span><span class="p">.</span><span class="n">best_estimator_</span> <span class="c1">#best estimator
</span><span class="k">print</span><span class="p">(</span><span class="s">"Best Model Parameter: "</span><span class="p">,</span><span class="n">forest_random</span><span class="p">.</span><span class="n">best_params_</span><span class="p">)</span>

<span class="c1">#    [RandomForestClassifier]
#      Train Accuracy:
#                  precision    recall  f1-score   support
#
#               B       1.00      1.00      1.00        67
#               M       1.00      1.00      1.00        75
#
#     avg / total       1.00      1.00      1.00       142
#
#
#      Test Accuracy:  
#                  precision    recall  f1-score   support
#
#               B       0.94      0.92      0.93        72
#               M       0.92      0.94      0.93        70
#
#     avg / total       0.93      0.93      0.93       142
</span></pre></table></code></div></div><p>So với default độ chính xác đã cải thiện được 2%.</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/blog/'>blog</a>, <a href='/categories/python/'>python</a>, <a href='/categories/scikit-learn/'>scikit-learn</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/blog/" class="post-tag no-text-decoration" >blog</a> <a href="/tags/python/" class="post-tag no-text-decoration" >python</a> <a href="/tags/scikit-learn/" class="post-tag no-text-decoration" >scikit-learn</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Tunning Hyper Parameter với scikit-learn - thanhtt&url=https://codetudau.com/posts/tuning-hyper-param-sklearn/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Tunning Hyper Parameter với scikit-learn - thanhtt&u=https://codetudau.com/posts/tuning-hyper-param-sklearn/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=Tunning Hyper Parameter với scikit-learn - thanhtt&url=https://codetudau.com/posts/tuning-hyper-param-sklearn/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink()" data-toggle="tooltip" data-placement="top" title="Copy link"></i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/cai-thien-count-base/">Cải thiện phương pháp Count Base với Pointwise Mutual Information</a><li><a href="/posts/phan-tich-cay-quyet-dinh-scikit-learn/">Phân tích cây quyết định với scikit-learn</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/blog/">blog</a> <a class="post-tag" href="/tags/python/">python</a> <a class="post-tag" href="/tags/scikit-learn/">scikit-learn</a> <a class="post-tag" href="/tags/deep-learning/">deep-learning</a> <a class="post-tag" href="/tags/nlp/">NLP</a> <a class="post-tag" href="/tags/pandas/">pandas</a> <a class="post-tag" href="/tags/recommender-system/">recommender system</a> <a class="post-tag" href="/tags/spark/">spark</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="widget-for-reem-15-1"></div><script src="https://reem.vn/reem.js?m=15"></script><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/bag-of-words-tf-idf-xu-ly-ngon-ngu-tu-nhien/"><div class="card-body"> <span class="timeago small" > Mar 9 <i class="unloaded">2021-03-09T07:33:00+07:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Bag of Words (Bow) TF-IDF - Xử lý ngôn ngữ tự nhiên</h3><div class="text-muted small"><p> Bag of Words là một thuật toán hỗ trợ xử lý ngôn ngữ tự nhiên và mục đích của BoW là phân loại text hay văn bản. Ý tưởng của BoW là phân tích và phân nhóm dựa theo “Bag of Words”(corpus). Với test ...</p></div></div></a></div><div class="card"> <a href="/posts/gioi-thieu-tien-xu-ly-trong-xu-ly-ngon-ngu-tu-nhien/"><div class="card-body"> <span class="timeago small" > Mar 9 <i class="unloaded">2021-03-09T08:33:00+07:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Giới thiệu tiền xử lý trong xử lý ngôn ngữ tự nhiên</h3><div class="text-muted small"><p> Mở đầu Chào các bạn, chắc hẳn ít nhiều các bạn đã từng nghe đến công việc xử lý ngôn ngữ tự nhiên. Nói một cách ngắn gọn như sau: Xử lý ngôn ngữ tự nhiên (natural language processing - NLP) là mộ...</p></div></div></a></div><div class="card"> <a href="/posts/phan-tich-cay-quyet-dinh-scikit-learn/"><div class="card-body"> <span class="timeago small" > Mar 7 <i class="unloaded">2021-03-07T14:33:00+07:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Phân tích cây quyết định với scikit-learn</h3><div class="text-muted small"><p> Phân tích cây quyết định (Decision Tree Analysis) Cây quyết định là một phương pháp phổ biến trong việc khai phá dữ liệu. Cây quyết định là mô hình hỗ trợ ra quyết định dựa trên đồ thị các điều kiệ...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/hoi-quy-tuyen-tinh/" class="btn btn-outline-primary" prompt="Older"><p>Hồi quy tuyến tính - Hồi quy đơn giản, phức tạp</p></a> <a href="/posts/phuong-phap-kmeans/" class="btn btn-outline-primary" prompt="Newer"><p>Tìm hiểu phương pháp Kmeans</p></a></div></div></div></div><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lozad/dist/lozad.min.js"></script> <script type="text/javascript"> const imgs = document.querySelectorAll('.post-content img'); const observer = lozad(imgs); observer.observe(); </script><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2021 <a href="https://twitter.com/username">thanhtt</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author."> Some rights reserved. </span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/blog/">blog</a> <a class="post-tag" href="/tags/python/">python</a> <a class="post-tag" href="/tags/scikit-learn/">scikit learn</a> <a class="post-tag" href="/tags/deep-learning/">deep learning</a> <a class="post-tag" href="/tags/nlp/">NLP</a> <a class="post-tag" href="/tags/pandas/">pandas</a> <a class="post-tag" href="/tags/recommender-system/">recommender system</a> <a class="post-tag" href="/tags/spark/">spark</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><script src="https://cdn.jsdelivr.net/npm/mermaid@8/dist/mermaid.min.js"></script> <script> $(function() { let initTheme = "default"; if ($("html[mode=dark]").length > 0 || ($("html[mode]").length == 0 && window.matchMedia("(prefers-color-scheme: dark)").matches ) ) { initTheme = "dark"; } let mermaidConf = { theme: initTheme /* <default|dark|forest|neutral> */ }; /* Markdown converts to HTML */ $("pre").has("code.language-mermaid").each(function() { let svgCode = $(this).children().html(); $(this).addClass("unloaded"); $(this).after(`<div class=\"mermaid\">${svgCode}</div>`); }); mermaid.initialize(mermaidConf); }); </script><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://codetudau.com{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script>
