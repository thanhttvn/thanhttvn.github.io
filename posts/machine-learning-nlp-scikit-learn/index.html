<!DOCTYPE html><html lang="vi" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="pv-cache-enabled" content="false"><meta name="generator" content="Jekyll v4.2.0" /><meta property="og:title" content="Machine Learning NLP - Text Classification sử dụng scikit-learn" /><meta name="author" content="thanhtt" /><meta property="og:locale" content="vi" /><meta name="description" content="Document/Text classification là 1 phần điển hình và quan trọng trong supervised machine learning. Phân loại các tài liệu(bài báo, tạp chí, trang web, hay là cả những status, comment trên MXH), nó có rất nhiều ứng dụng trong việc phân loại spam mail, email routing, sentiment analysis hay ứng dụng vào tạo chatbot. Trong bài này, tôi sẽ giới thiệu đến với các bạn cách ứng dụng python, cụ thể là sử dụng thư viện scikit-learn để tiến hành phân loại text để giải quyết bài toán thực tế là tạo nền tảng cho chatbot." /><meta property="og:description" content="Document/Text classification là 1 phần điển hình và quan trọng trong supervised machine learning. Phân loại các tài liệu(bài báo, tạp chí, trang web, hay là cả những status, comment trên MXH), nó có rất nhiều ứng dụng trong việc phân loại spam mail, email routing, sentiment analysis hay ứng dụng vào tạo chatbot. Trong bài này, tôi sẽ giới thiệu đến với các bạn cách ứng dụng python, cụ thể là sử dụng thư viện scikit-learn để tiến hành phân loại text để giải quyết bài toán thực tế là tạo nền tảng cho chatbot." /><link rel="canonical" href="https://codetudau.com/posts/machine-learning-nlp-scikit-learn/" /><meta property="og:url" content="https://codetudau.com/posts/machine-learning-nlp-scikit-learn/" /><meta property="og:site_name" content="thanhtt" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2021-03-09T09:33:00+07:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Machine Learning NLP - Text Classification sử dụng scikit-learn" /><meta name="twitter:site" content="@twitter_username" /><meta name="twitter:creator" content="@thanhtt" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"headline":"Machine Learning NLP - Text Classification sử dụng scikit-learn","dateModified":"2021-03-09T09:33:00+07:00","datePublished":"2021-03-09T09:33:00+07:00","description":"Document/Text classification là 1 phần điển hình và quan trọng trong supervised machine learning. Phân loại các tài liệu(bài báo, tạp chí, trang web, hay là cả những status, comment trên MXH), nó có rất nhiều ứng dụng trong việc phân loại spam mail, email routing, sentiment analysis hay ứng dụng vào tạo chatbot. Trong bài này, tôi sẽ giới thiệu đến với các bạn cách ứng dụng python, cụ thể là sử dụng thư viện scikit-learn để tiến hành phân loại text để giải quyết bài toán thực tế là tạo nền tảng cho chatbot.","url":"https://codetudau.com/posts/machine-learning-nlp-scikit-learn/","mainEntityOfPage":{"@type":"WebPage","@id":"https://codetudau.com/posts/machine-learning-nlp-scikit-learn/"},"@type":"BlogPosting","author":{"@type":"Person","name":"thanhtt"},"@context":"https://schema.org"}</script><title>Machine Learning NLP - Text Classification sử dụng scikit-learn | thanhtt</title><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon.png"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon-precomposed.png"><link rel="apple-touch-icon" sizes="57x57" href="/assets/img/favicons/apple-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="/assets/img/favicons/apple-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/assets/img/favicons/apple-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/assets/img/favicons/apple-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/assets/img/favicons/apple-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/assets/img/favicons/apple-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/assets/img/favicons/apple-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/assets/img/favicons/apple-icon-152x152.png"><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-icon-180x180.png"><link rel="icon" type="image/png" sizes="192x192" href="/assets/img/favicons/android-icon-192x192.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="96x96" href="/assets/img/favicons/favicon-96x96.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/manifest.json"><meta name='msapplication-config' content='/assets/img/favicons/browserconfig.xml'><meta name="msapplication-TileColor" content="#ffffff"><meta name="msapplication-TileImage" content="/assets/img/favicons/ms-icon-144x144.png"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="cdn.jsdelivr.net"><link rel="dns-prefetch" href="cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css" integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script defer src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script defer src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id="></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', ''); }); </script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="/assets/img/avatar/ttt-avatar.png" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">thanhtt</a></div><div class="site-subtitle font-italic">thanhtt - Data Engineer</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center"> <a href="https://github.com/thanhttvn" aria-label="github" class="order-3" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a> <a href="https://twitter.com/twitter_username" aria-label="twitter" class="order-4" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['thanhtt.vn93','gmail.com'].join('@')" aria-label="email" class="order-5" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" class="order-6" > <i class="fas fa-rss"></i> </a> <span class="icon-border order-2"></span> <span id="mode-toggle-wrapper" class="order-1"> <i class="mode-toggle fas fa-adjust"></i> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } var self = this; /* always follow the system prefers */ this.sysDarkPrefers.addListener(function() { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.updateMermaid(); }); } /* constructor() */ setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode == ModeToggle.DARK_MODE; } get isLightMode() { return this.mode == ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer) ) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } updateMermaid() { if (typeof mermaid !== "undefined") { let expectedTheme = (this.modeStatus === ModeToggle.DARK_MODE? "dark" : "default"); let config = { theme: expectedTheme }; /* re-render the SVG › <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */ $(".mermaid").each(function() { let svgCode = $(this).prev().children().html(); $(this).removeAttr("data-processed"); $(this).html(svgCode); }); mermaid.initialize(config); mermaid.init(undefined, ".mermaid"); } } flipMode() { if (this.hasMode) { if (this.isSysDarkPrefer) { if (this.isLightMode) { this.clearMode(); } else { this.setLight(); } } else { if (this.isDarkMode) { this.clearMode(); } else { this.setDark(); } } } else { if (this.isSysDarkPrefer) { this.setLight(); } else { this.setDark(); } } this.updateMermaid(); } /* flipMode() */ } /* ModeToggle */ let toggle = new ModeToggle(); $(".mode-toggle").click(function() { toggle.flipMode(); }); </script> </span></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Posts </a> </span> <span>Machine Learning NLP - Text Classification sử dụng scikit-learn</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Machine Learning NLP - Text Classification sử dụng scikit-learn</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="semi-bold"> thanhtt </span> <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Tue, Mar 9, 2021, 9:33 AM +0700" prep="on" > Mar 9 <i class="unloaded">2021-03-09T09:33:00+07:00</i> </span></div><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1709 words">9 min</span></div></div><div class="post-content"> <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/posts/2018/01/trang-bia-1.png" class="preview-img" alt="Preview Image"><p>Document/Text classification là 1 phần điển hình và quan trọng trong supervised machine learning. Phân loại các tài liệu(bài báo, tạp chí, trang web, hay là cả những status, comment trên MXH), nó có rất nhiều ứng dụng trong việc phân loại spam mail, email routing, sentiment analysis hay ứng dụng vào tạo chatbot. Trong bài này, tôi sẽ giới thiệu đến với các bạn cách ứng dụng python, cụ thể là sử dụng thư viện scikit-learn để tiến hành phân loại text để giải quyết bài toán thực tế là tạo nền tảng cho chatbot.</p><h1 id="bước-1-chuẩn-bị-môi-trường">Bước 1: Chuẩn bị môi trường</h1><p>Bài viết này tôi sử dụng <a href="https://www.jetbrains.com/pycharm/">Pycharm</a> để viết code. Để nhanh gọn lẹ hơn, bạn hoàn toàn có thể dùng jupyter notebook nhé. Thư viện thì bạn chỉ cần cài đặt <a href="https://www.anaconda.com/download/">anaconda</a> tương ứng với os bạn đang sử dụng.</p><h1 id="bước-2-dữ-liệu-và-tiền-xử-lý">Bước 2: Dữ liệu và tiền xử lý</h1><p>Đầu tiên không thể không kể đến là việc chuẩn bị dữ liệu, do mình không tìm được nguồn dữ liệu nào thích hợp, đầy đủ và chính xác nên mình sẽ xây dựng chatbot theo hướng ít dữ liệu training, cụ thể như sau:</p><p>Ví dụ bạn muốn hỏi chatbot thời tiết ngày mai thế nào? Sẽ có vô vàn cách hỏi khác nhau phải không:</p><ul><li>Mai trời mưa không nhỉ ?<li>Mai liệu nắng không nhỉ ?<li>Ngày mai thời tiết thế nào em ơi ?<li>Em nghe nói ngày mai thời tiết đẹp lắm phải không ?<li>….</ul><p>Đó, cùng một nội dung là hỏi thời tiết ngày mai nhưng với mỗi người, mỗi hoàn cảnh, cảm xúc khác nhau, chúng ta lại có những cách hỏi khác nhau. Với trường hợp như vậy chúng ta không thể viết code theo phương pháp truyền thống là sử dụng if else, switch case được phải không. OK, bạn đã hình dung ra được vấn đề chưa ?</p><p>Đây chính là lúc ứng dụng bài toán <strong>Text Classification</strong> để giải quyết. Công việc chúng ta là làm cách nào đó để với những câu hỏi như trên sẽ phân loại về 1 class có tên là “hoi_thoi_tiet” chẳng hạn.</p><p>Hướng giải quyết của mình là với mỗi nhóm câu hỏi chuẩn bị sẵn từ 3-5 mẫu câu hỏi để làm training data. Sau đó sử dụng phương pháp <strong>Bag-of-words, TF-IDF</strong>, và cuối cùng là sử dụng 1 model tiến hành classification. Nếu bạn chưa biết <strong>Bag-of-words, TF-IDF</strong> là gì thì hãy tham khảo tại <a href="http://codetudau.com/bag-of-words-tf-idf-xu-ly-ngon-ngu-tu-nhien/">bài viết trước</a> của mình nhé.</p><p>Tiếp theo là công đoạn tiền xử lý tiếng việt, mình cũng đã có 1 bài viết nói về vấn đề này tại <a href="http://codetudau.com/gioi-thieu-tien-xu-ly-trong-xu-ly-ngon-ngu-tu-nhien/">đây</a>, điều khó khăn nhất là:</p><p>Trong tiếng Việt, dấu cách (space) không được sử dụng như 1 kí hiệu phân tách từ, nó chỉ có ý nghĩa phân tách các âm tiết với nhau. Vì thế, để xử lý tiếng Việt, công đoạn tách từ (word segmentation) là 1 trong những bài toán cơ bản và quan trọng bậc nhất.</p><p>Ví dụ : từ “đất nước” được tạo ra từ 2 âm tiết “đất” và “nước”, cả 2 âm tiết này đều có nghĩa riêng khi đứng độc lập, nhưng khi ghép lại sẽ mang một nghĩa khác.</p><p>Vì đặc điểm này, bài toán tách từ trở thành 1 bài toán tiền đề cho các ứng dụng xử lý ngôn ngữ tự nhiên khác như phân loại văn bản, tóm tắt văn bản, máy dịch tự động, …</p><p>Về bài toán vietnamese word-segmentation:</p><p>Để giải quyết bài toán này cũng cần một lượng lớn dữ liệu. Dữ liệu đó đòi hỏi sự chính xác cao và tốn rất nhiều công sức. Tuy nhiên hiện nay cộng động xử lý ngôn ngữ tự nhiên tiếng việt khá mạnh nên có rất nhiều mã nguồn chất lượng. Với độ chính xác khá cao, dễ dàng sử dụng nên mình sử dụng thư viện <a href="https://pypi.python.org/pypi/pyvi">pyvi</a> có sẵn trên python. Bạn muốn tự làm công đoạn này hoặc muốn tìm hiểu sâu hơn về phương pháp thì hãy tham khảo thêm phần link đính kèm cuối bài viết nhé.</p><h1 id="bước-3-trích-xuất-đặc-trưng-extracting-features">Bước 3: Trích xuất đặc trưng (Extracting features)</h1><p>Để có thể sử dụng ML algorithms bạn cần vector hóa văn bản, đoạn text đầu vào. Như đã nói ở trên mình sử dụng <strong>Bag-of-words</strong>. Đầu vào của <strong>Bag-of-words</strong> là đoạn text đã được tách từ sử dụng <strong>pyvi</strong>.</p><p>Đây là đoạn code sử dụng <strong>pyvi</strong> thực hiện tách từ.</p><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre><td class="rouge-code"><pre><span class="kn">from</span> <span class="nn">pyvi.pyvi</span> <span class="kn">import</span> <span class="n">ViTokenizer</span><span class="p">,</span> <span class="n">ViPosTagger</span>
<span class="kn">from</span> <span class="nn">sklearn.base</span> <span class="kn">import</span> <span class="n">TransformerMixin</span><span class="p">,</span> <span class="n">BaseEstimator</span>


<span class="k">class</span> <span class="nc">FeatureTransformer</span><span class="p">(</span><span class="n">BaseEstimator</span><span class="p">,</span> <span class="n">TransformerMixin</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">tokenizer</span> <span class="o">=</span> <span class="n">ViTokenizer</span><span class="p">()</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">pos_tagger</span> <span class="o">=</span> <span class="n">ViPosTagger</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">_</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">transform</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="o">**</span><span class="n">fit_params</span><span class="p">):</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">X</span><span class="p">.</span><span class="nb">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">text</span><span class="p">:</span> <span class="bp">self</span><span class="p">.</span><span class="n">tokenizer</span><span class="p">.</span><span class="n">tokenize</span><span class="p">(</span><span class="n">text</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">result</span>

</pre></table></code></div></div><p>Sau đó sẽ dùng phương pháp <strong>Bag-of-words</strong> như mình đã giới thiệu ở bài trước để vector hóa từng câu sau khi được tách từ.</p><p>Bài này tôi cũng sử dụng Pipeline, tại sao nên sử dụng Pipeline và cách sử dụng nếu các bạn chưa rõ thì có thể xem tại bài viết trước của tôi <a href="http://codetudau.com/lam-quen-pipeline-sklearn-python/">tại đây</a>.</p><h1 id="bước-4-lựa-chọn-ml-algorithms">Bước 4: Lựa chọn ML algorithms</h1><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/posts/2018/01/ml_map.png" alt="ml_map" /></p><p>Trên đây là tổng hợp các trường hợp thực tế, đối với lượng data nhiều hay ít và đối tượng bài toán chúng ta sẽ chọn được model phù hợp.</p><p>Trong trường hợp của mình vì lượng data rất ít nên khi tiến hành <strong>Text classification</strong> được khuyên nên sử dụng <strong>Naive Bayes</strong>. Thuật toán này ra sao thì mình không nhắc lại nữa. Thuật toán này cài đặt khá đơn giản, dễ hiểu và độ chính xác rất cao. Bạn có thể tham khảo link wiki <a href="https://en.wikipedia.org/wiki/Naive_Bayes_classifier">tại đây</a> , có ví dụ rất dễ hiểu.</p><p>Với việc sử dụng <strong>Pipeline</strong> và thư viện sklearn, việc viết code trở nên rất đơn giản.</p><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
</pre><td class="rouge-code"><pre><span class="kn">from</span> <span class="nn">sklearn.naive_bayes</span> <span class="kn">import</span> <span class="n">MultinomialNB</span>
<span class="kn">from</span> <span class="nn">sklearn.pipeline</span> <span class="kn">import</span> <span class="n">Pipeline</span>
<span class="kn">from</span> <span class="nn">sklearn.feature_extraction.text</span> <span class="kn">import</span> <span class="n">CountVectorizer</span>
<span class="kn">from</span> <span class="nn">sklearn.feature_extraction.text</span> <span class="kn">import</span> <span class="n">TfidfTransformer</span>
<span class="kn">from</span> <span class="nn">src.transformer.feature_transformer</span> <span class="kn">import</span> <span class="n">FeatureTransformer</span>


<span class="k">class</span> <span class="nc">NaiveBayesModel</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">clf</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">_init_pipeline</span><span class="p">()</span>

    <span class="o">@</span><span class="nb">staticmethod</span>
    <span class="k">def</span> <span class="nf">_init_pipeline</span><span class="p">():</span>
        <span class="n">pipe_line</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">([</span>
            <span class="p">(</span><span class="s">"transformer"</span><span class="p">,</span> <span class="n">FeatureTransformer</span><span class="p">()),</span><span class="c1">#sử dụng pyvi tiến hành word segmentation
</span>            <span class="p">(</span><span class="s">"vect"</span><span class="p">,</span> <span class="n">CountVectorizer</span><span class="p">()),</span><span class="c1">#bag-of-words
</span>            <span class="p">(</span><span class="s">"tfidf"</span><span class="p">,</span> <span class="n">TfidfTransformer</span><span class="p">()),</span><span class="c1">#tf-idf
</span>            <span class="p">(</span><span class="s">"clf"</span><span class="p">,</span> <span class="n">MultinomialNB</span><span class="p">())</span><span class="c1">#model naive bayes
</span>        <span class="p">])</span>

        <span class="k">return</span> <span class="n">pipe_line</span>
</pre></table></code></div></div><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
</pre><td class="rouge-code"><pre><span class="c1">#!/usr/bin/env python
# -*- coding: utf-8 -*-
</span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="n">pd</span>
<span class="kn">from</span> <span class="nn">model.svm_model</span> <span class="kn">import</span> <span class="n">SVMModel</span>
<span class="kn">from</span> <span class="nn">model.naive_bayes_model</span> <span class="kn">import</span> <span class="n">NaiveBayesModel</span>


<span class="k">class</span> <span class="nc">TextClassificationPredict</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">test</span> <span class="o">=</span> <span class="bp">None</span>

    <span class="k">def</span> <span class="nf">get_train_data</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># Tạo train data
</span>        <span class="n">train_data</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">train_data</span><span class="p">.</span><span class="n">append</span><span class="p">({</span><span class="s">"feature"</span><span class="p">:</span> <span class="sa">u</span><span class="s">"Hôm nay trời đẹp không ?"</span><span class="p">,</span> <span class="s">"target"</span><span class="p">:</span> <span class="s">"hoi_thoi_tiet"</span><span class="p">})</span>
        <span class="n">train_data</span><span class="p">.</span><span class="n">append</span><span class="p">({</span><span class="s">"feature"</span><span class="p">:</span> <span class="sa">u</span><span class="s">"Hôm nay thời tiết thế nào ?"</span><span class="p">,</span> <span class="s">"target"</span><span class="p">:</span> <span class="s">"hoi_thoi_tiet"</span><span class="p">})</span>
        <span class="n">train_data</span><span class="p">.</span><span class="n">append</span><span class="p">({</span><span class="s">"feature"</span><span class="p">:</span> <span class="sa">u</span><span class="s">"Hôm nay mưa không ?"</span><span class="p">,</span> <span class="s">"target"</span><span class="p">:</span> <span class="s">"hoi_thoi_tiet"</span><span class="p">})</span>
        <span class="n">train_data</span><span class="p">.</span><span class="n">append</span><span class="p">({</span><span class="s">"feature"</span><span class="p">:</span> <span class="sa">u</span><span class="s">"Chào em gái"</span><span class="p">,</span> <span class="s">"target"</span><span class="p">:</span> <span class="s">"chao_hoi"</span><span class="p">})</span>
        <span class="n">train_data</span><span class="p">.</span><span class="n">append</span><span class="p">({</span><span class="s">"feature"</span><span class="p">:</span> <span class="sa">u</span><span class="s">"Chào bạn"</span><span class="p">,</span> <span class="s">"target"</span><span class="p">:</span> <span class="s">"chao_hoi"</span><span class="p">})</span>
        <span class="n">train_data</span><span class="p">.</span><span class="n">append</span><span class="p">({</span><span class="s">"feature"</span><span class="p">:</span> <span class="sa">u</span><span class="s">"Hello bạn"</span><span class="p">,</span> <span class="s">"target"</span><span class="p">:</span> <span class="s">"chao_hoi"</span><span class="p">})</span>
        <span class="n">train_data</span><span class="p">.</span><span class="n">append</span><span class="p">({</span><span class="s">"feature"</span><span class="p">:</span> <span class="sa">u</span><span class="s">"Hi kimi"</span><span class="p">,</span> <span class="s">"target"</span><span class="p">:</span> <span class="s">"chao_hoi"</span><span class="p">})</span>
        <span class="n">train_data</span><span class="p">.</span><span class="n">append</span><span class="p">({</span><span class="s">"feature"</span><span class="p">:</span> <span class="sa">u</span><span class="s">"Hi em"</span><span class="p">,</span> <span class="s">"target"</span><span class="p">:</span> <span class="s">"chao_hoi"</span><span class="p">})</span>
        <span class="n">df_train</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">train_data</span><span class="p">)</span>

        <span class="c1"># Tạo test data
</span>        <span class="n">test_data</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">test_data</span><span class="p">.</span><span class="n">append</span><span class="p">({</span><span class="s">"feature"</span><span class="p">:</span> <span class="sa">u</span><span class="s">"Nóng quá, liệu mưa không em ơi?"</span><span class="p">,</span> <span class="s">"target"</span><span class="p">:</span> <span class="s">"hoi_thoi_tiet"</span><span class="p">})</span>
        <span class="n">df_test</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">test_data</span><span class="p">)</span>

        <span class="c1"># init model naive bayes
</span>        <span class="n">model</span> <span class="o">=</span> <span class="n">NaiveBayesModel</span><span class="p">()</span>

        <span class="n">clf</span> <span class="o">=</span> <span class="n">model</span><span class="p">.</span><span class="n">clf</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">df_train</span><span class="p">[</span><span class="s">"feature"</span><span class="p">],</span> <span class="n">df_train</span><span class="p">.</span><span class="n">target</span><span class="p">)</span>

        <span class="n">predicted</span> <span class="o">=</span> <span class="n">clf</span><span class="p">.</span><span class="n">predict</span><span class="p">(</span><span class="n">df_test</span><span class="p">[</span><span class="s">"feature"</span><span class="p">])</span>

        <span class="c1"># Print predicted result
</span>        <span class="k">print</span> <span class="n">predicted</span>
        <span class="k">print</span> <span class="n">clf</span><span class="p">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">df_test</span><span class="p">[</span><span class="s">"feature"</span><span class="p">])</span>


<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">'__main__'</span><span class="p">:</span>
    <span class="n">tcp</span> <span class="o">=</span> <span class="n">TextClassificationPredict</span><span class="p">()</span>
    <span class="n">tcp</span><span class="p">.</span><span class="n">get_train_data</span><span class="p">()</span>
</pre></table></code></div></div><p>Như code mình viết ở trên, tạm thời có 2 class cần phân loại là <strong>hoi_thoi_tiet</strong> và <strong>chao_hoi</strong>, mỗi class mình có vài câu sử dụng làm training. Test data chính là câu <strong>“Nóng quá, liệu mưa không em ơi?”</strong> Thử xem có phân loại đúng không nhé.</p><p>Kết quả:</p><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="c1">#predicted result
</span><span class="p">[</span><span class="s">'hoi_thoi_tiet'</span><span class="p">]</span>
<span class="c1">#predict_proba
</span><span class="p">[[</span> <span class="mf">0.05407486</span>  <span class="mf">0.94592514</span><span class="p">]]</span>
</pre></table></code></div></div><p>Nhận thấy kết quả rất chính xác, có đến 94,59% dự đoán về class <strong>hoi_thoi_tiet</strong>. Có 1 lưu ý là model trên chưa tiến hành tuning hyper parameter. Nếu bạn chưa biết về quá trình tuning parameter thì có thể tham khảo bài viết của mình <a href="http://codetudau.com/tim-kiem-high-parameter-voi-scikit-learn/">tại đây</a>.</p><p>Tuy nhiên việc xác định độ chính xác thì cần 1 lượng kha khá dữ liệu thì kết quả mới chính xác nhé.</p><p>Từ ví dụ trên bạn hoàn toàn có thể tự xây dựng 1 hệ thống chatbot cho riêng mình, dữ liệu bạn càng nhiều thì chatbot của bạn càng có khả năng trả lời nhiều câu hỏi, trò chuyện được nhiều hơn. ^^ Đơn giản như việc hỏi thời tiết, sau khi predict về class <strong>hoi_thoi_tiet</strong> bạn code call api weather để lấy thông tin thời tiết và trả lời cho người dùng, rất hữu ích phải không.</p><p>Ví dụ như em này:</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/posts/2018/01/----------2018-01-28-22.33.20.png" alt="----------2018-01-28-22.33.20" /></p><h1 id="bước-4b">Bước 4b:</h1><p>Trong trường hợp bạn có 1 lượng lớn data, như trên sơ đồ là hơn 100k samples, bạn có thể thử dùng Support Vector Machines. Tuy dữ liệu mình ít nhưng cũng thử xem sao:</p><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
</pre><td class="rouge-code"><pre><span class="kn">from</span> <span class="nn">sklearn.pipeline</span> <span class="kn">import</span> <span class="n">Pipeline</span>
<span class="kn">from</span> <span class="nn">sklearn.feature_extraction.text</span> <span class="kn">import</span> <span class="n">CountVectorizer</span>
<span class="kn">from</span> <span class="nn">sklearn.feature_extraction.text</span> <span class="kn">import</span> <span class="n">TfidfTransformer</span>
<span class="kn">from</span> <span class="nn">src.transformer.feature_transformer</span> <span class="kn">import</span> <span class="n">FeatureTransformer</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">SGDClassifier</span>


<span class="k">class</span> <span class="nc">SVMModel</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">clf</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">_init_pipeline</span><span class="p">()</span>

    <span class="o">@</span><span class="nb">staticmethod</span>
    <span class="k">def</span> <span class="nf">_init_pipeline</span><span class="p">():</span>
        <span class="n">pipe_line</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">([</span>
            <span class="p">(</span><span class="s">"transformer"</span><span class="p">,</span> <span class="n">FeatureTransformer</span><span class="p">()),</span>
            <span class="p">(</span><span class="s">"vect"</span><span class="p">,</span> <span class="n">CountVectorizer</span><span class="p">()),</span>
            <span class="p">(</span><span class="s">"tfidf"</span><span class="p">,</span> <span class="n">TfidfTransformer</span><span class="p">()),</span>
            <span class="p">(</span><span class="s">"clf-svm"</span><span class="p">,</span> <span class="n">SGDClassifier</span><span class="p">(</span><span class="n">loss</span><span class="o">=</span><span class="s">'log'</span><span class="p">,</span> <span class="n">penalty</span><span class="o">=</span><span class="s">'l2'</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">1e-3</span><span class="p">,</span> <span class="n">n_iter</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="bp">None</span><span class="p">))</span>
        <span class="p">])</span>

        <span class="k">return</span> <span class="n">pipe_line</span>
</pre></table></code></div></div><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="p">[</span><span class="s">'hoi_thoi_tiet'</span><span class="p">]</span>
<span class="p">[[</span> <span class="mf">0.07582323</span>  <span class="mf">0.92417677</span><span class="p">]]</span>
</pre></table></code></div></div><p>Kết quả phân loại cũng chính xác. Tuy nhiên mình chưa có data đủ lớn để đánh giá accuracy cho các model trên.</p><p>Cụ thể về SVM thì mình sẽ cập nhật vào bài viết tiếp theo.</p><h1 id="kết-luận">Kết luận</h1><p>Text Classification là 1 bài toán khá hay và nhiều ứng dụng trong thực tế. Ngoài Naive Bayes, SVM, bạn hoàn toàn có thể dùng Random Forest, SLDA, Logistic Regression, Decision Trees, Neural Networks, Boosting and Bagging algorithms … Và tất nhiên không có model nào tốt nhất, trong thực tế bạn cần thử, đánh giá nhiều model và tiến hành tuning parameter để có thể đạt kết quả tốt nhất.</p><p>Mong bài viết đem lại lợi ích cho các bạn. Hẹn gặp lại các bạn ở các bài viết sau.</p><p><strong>Full source code</strong> https://github.com/thanhttvn/machinelearning_codetudau/tree/master/text_classification_example</p><h1 id="link-tham-khảo">Link tham khảo</h1><p>http://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.106.220&amp;rep=rep1&amp;type=pdf</p><p>https://www.scribd.com/fullscreen/342411823?access_key=key-UJOfjnzF9fZfZiAgnaR8</p><p>https://github.com/magizbox/underthesea/wiki/Vietnamese-NLP-Tools#text-classification</p><p>http://www.clc.hcmus.edu.vn/wp-content/uploads/2016/01/CLC_Vietnamese-Word-Segmentation.pdf</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/blog/'>blog</a>, <a href='/categories/python/'>python</a>, <a href='/categories/nlp/'>NLP</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/blog/" class="post-tag no-text-decoration" >blog</a> <a href="/tags/python/" class="post-tag no-text-decoration" >python</a> <a href="/tags/nlp/" class="post-tag no-text-decoration" >NLP</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Machine Learning NLP - Text Classification sử dụng scikit-learn - thanhtt&url=https://codetudau.com/posts/machine-learning-nlp-scikit-learn/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Machine Learning NLP - Text Classification sử dụng scikit-learn - thanhtt&u=https://codetudau.com/posts/machine-learning-nlp-scikit-learn/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=Machine Learning NLP - Text Classification sử dụng scikit-learn - thanhtt&url=https://codetudau.com/posts/machine-learning-nlp-scikit-learn/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink()" data-toggle="tooltip" data-placement="top" title="Copy link"></i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/cai-thien-count-base/">Cải thiện phương pháp Count Base với Pointwise Mutual Information</a><li><a href="/posts/phan-tich-cay-quyet-dinh-scikit-learn/">Phân tích cây quyết định với scikit-learn</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/blog/">blog</a> <a class="post-tag" href="/tags/python/">python</a> <a class="post-tag" href="/tags/scikit-learn/">scikit-learn</a> <a class="post-tag" href="/tags/deep-learning/">deep-learning</a> <a class="post-tag" href="/tags/nlp/">NLP</a> <a class="post-tag" href="/tags/pandas/">pandas</a> <a class="post-tag" href="/tags/recommender-system/">recommender system</a> <a class="post-tag" href="/tags/spark/">spark</a></div></div></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="widget-for-reem-15-1"></div><script src="https://reem.vn/reem.js?m=15"></script><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/cai-thien-count-base/"><div class="card-body"> <span class="timeago small" > Mar 9 <i class="unloaded">2021-03-09T18:33:00+07:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Cải thiện phương pháp Count Base với Pointwise Mutual Information</h3><div class="text-muted small"><p> Ở bài viết trước mình đã giới thiệu với các bạn một phương pháp vector hoá từ có tên là Count Base. Dựa vào việc tạo ra một co-occurence matrix của từ, chắc hẳn bạn đã tạo được vector của từ rồi nh...</p></div></div></a></div><div class="card"> <a href="/posts/bag-of-words-tf-idf-xu-ly-ngon-ngu-tu-nhien/"><div class="card-body"> <span class="timeago small" > Mar 9 <i class="unloaded">2021-03-09T07:33:00+07:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Bag of Words (Bow) TF-IDF - Xử lý ngôn ngữ tự nhiên</h3><div class="text-muted small"><p> Bag of Words là một thuật toán hỗ trợ xử lý ngôn ngữ tự nhiên và mục đích của BoW là phân loại text hay văn bản. Ý tưởng của BoW là phân tích và phân nhóm dựa theo “Bag of Words”(corpus). Với test ...</p></div></div></a></div><div class="card"> <a href="/posts/gioi-thieu-tien-xu-ly-trong-xu-ly-ngon-ngu-tu-nhien/"><div class="card-body"> <span class="timeago small" > Mar 9 <i class="unloaded">2021-03-09T08:33:00+07:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Giới thiệu tiền xử lý trong xử lý ngôn ngữ tự nhiên</h3><div class="text-muted small"><p> Mở đầu Chào các bạn, chắc hẳn ít nhiều các bạn đã từng nghe đến công việc xử lý ngôn ngữ tự nhiên. Nói một cách ngắn gọn như sau: Xử lý ngôn ngữ tự nhiên (natural language processing - NLP) là mộ...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/gioi-thieu-tien-xu-ly-trong-xu-ly-ngon-ngu-tu-nhien/" class="btn btn-outline-primary" prompt="Older"><p>Giới thiệu tiền xử lý trong xử lý ngôn ngữ tự nhiên</p></a> <a href="/posts/luu-y-khi-lam-viec-voi-bigdata/" class="btn btn-outline-primary" prompt="Newer"><p>Một vài lưu ý khi làm việc với BigData</p></a></div></div></div></div><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lozad/dist/lozad.min.js"></script> <script type="text/javascript"> const imgs = document.querySelectorAll('.post-content img'); const observer = lozad(imgs); observer.observe(); </script><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2021 <a href="https://twitter.com/username">thanhtt</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author."> Some rights reserved. </span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/blog/">blog</a> <a class="post-tag" href="/tags/python/">python</a> <a class="post-tag" href="/tags/scikit-learn/">scikit learn</a> <a class="post-tag" href="/tags/deep-learning/">deep learning</a> <a class="post-tag" href="/tags/nlp/">NLP</a> <a class="post-tag" href="/tags/pandas/">pandas</a> <a class="post-tag" href="/tags/recommender-system/">recommender system</a> <a class="post-tag" href="/tags/spark/">spark</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><script src="https://cdn.jsdelivr.net/npm/mermaid@8/dist/mermaid.min.js"></script> <script> $(function() { let initTheme = "default"; if ($("html[mode=dark]").length > 0 || ($("html[mode]").length == 0 && window.matchMedia("(prefers-color-scheme: dark)").matches ) ) { initTheme = "dark"; } let mermaidConf = { theme: initTheme /* <default|dark|forest|neutral> */ }; /* Markdown converts to HTML */ $("pre").has("code.language-mermaid").each(function() { let svgCode = $(this).children().html(); $(this).addClass("unloaded"); $(this).after(`<div class=\"mermaid\">${svgCode}</div>`); }); mermaid.initialize(mermaidConf); }); </script><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://codetudau.com{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script>
